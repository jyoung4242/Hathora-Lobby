(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();function P(n){this.message=n}P.prototype=new Error,P.prototype.name="InvalidCharacterError";var J=typeof window<"u"&&window.atob&&window.atob.bind(window)||function(n){var e=String(n).replace(/=+$/,"");if(e.length%4==1)throw new P("'atob' failed: The string to be decoded is not correctly encoded.");for(var t,r,s=0,i=0,o="";r=e.charAt(i++);~r&&(t=s%4?64*t+r:r,s++%4)?o+=String.fromCharCode(255&t>>(-2*s&6)):0)r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(r);return o};function oe(n){var e=n.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw"Illegal base64url string!"}try{return function(t){return decodeURIComponent(J(t).replace(/(.)/g,function(r,s){var i=s.charCodeAt(0).toString(16).toUpperCase();return i.length<2&&(i="0"+i),"%"+i}))}(e)}catch{return J(e)}}function V(n){this.message=n}function ae(n,e){if(typeof n!="string")throw new V("Invalid token specified");var t=(e=e||{}).header===!0?0:1;try{return JSON.parse(oe(n.split(".")[t]))}catch(r){throw new V("Invalid token specified: "+r.message)}}V.prototype=new Error,V.prototype.name="InvalidTokenError";var k=null;typeof WebSocket<"u"?k=WebSocket:typeof MozWebSocket<"u"?k=MozWebSocket:typeof global<"u"?k=global.WebSocket||global.MozWebSocket:typeof window<"u"?k=window.WebSocket||window.MozWebSocket:typeof self<"u"&&(k=self.WebSocket||self.MozWebSocket);const le=k;class ce{roomId;connectionInfo;socket;messageListeners=[];closeListeners=[];stringEncoder=new TextEncoder;stringDecoder=new TextDecoder;constructor(e,t){this.roomId=e,this.connectionInfo=t}onMessage(e){this.messageListeners.push(e)}onMessageString(e){this.messageListeners.push(t=>{e(this.stringDecoder.decode(t))})}onMessageJson(e){this.onMessageString(t=>{e(JSON.parse(t))})}onClose(e){this.closeListeners.push(e)}async connect(e){const{host:t,port:r,transportType:s}=this.connectionInfo;return this.socket=new le(`${s==="tls"?"wss":"ws"}://${t}:${r}/${this.roomId}?token=${e}`),this.socket.binaryType="arraybuffer",new Promise((i,o)=>{this.socket.onopen=()=>{i()},this.socket.onclose=l=>{o(l.reason),this._onClose(l)},this.socket.onmessage=({data:l})=>{if(!(l instanceof ArrayBuffer))throw new Error("Unexpected data type: "+typeof l);this._onMessage(l)}})}write(e){this.socket?.send(e)}writeString(e){this.write(this.stringEncoder.encode(e))}writeJson(e){this.writeString(JSON.stringify(e))}disconnect(e){e===void 0&&(this.socket.onclose=()=>{}),this.socket.close(e)}_onMessage(e){this.messageListeners.forEach(t=>t(e))}_onClose(e){this.closeListeners.forEach(t=>t(e))}}class Y{appId;localConnectionInfo;static getUserFromToken(e){return ae(e)}constructor(e,t){this.appId=e,this.localConnectionInfo=t}async loginAnonymous(){return(await this.postJson(`https://api.hathora.dev/v2/auth/${this.appId}/login/anonymous`,{})).token}async loginNickname(e){return(await this.postJson(`https://api.hathora.dev/v2/auth/${this.appId}/login/nickname`,{nickname:e})).token}async loginGoogle(e){return(await this.postJson(`https://api.hathora.dev/v2/auth/${this.appId}/login/google`,{idToken:e})).token}async createPrivateLobby(e){return await this.postJson(`https://api.hathora.dev/v2/lobby/${this.appId}/create/unlisted?local=${this.localConnectionInfo===void 0?"false":"true"}`,{},{Authorization:e})}async createPublicLobby(e){return await this.postJson(`https://api.hathora.dev/v2/lobby/${this.appId}/create/public?local=${this.localConnectionInfo===void 0?"false":"true"}`,{},{Authorization:e})}async getPublicLobbies(e,t){const r=t===void 0?"":`region=${t}&`;return await(await fetch(`https://api.hathora.dev/v2/lobby/${this.appId}/list?${r}local=${this.localConnectionInfo===void 0?"false":"true"}`,{headers:{Authorization:e}})).json()}async getConnectionInfoForRoomId(e){return this.localConnectionInfo!==void 0?this.localConnectionInfo:await(await fetch(`https://api.hathora.dev/v2/rooms/${this.appId}/connectioninfo/${e}`)).json()}async newConnection(e){const t=await this.getConnectionInfoForRoomId(e);return new ce(e,t)}async postJson(e,t,r={}){return await(await fetch(e,{method:"POST",headers:{...r,"Content-Type":"application/json"},body:JSON.stringify(t)})).json()}}class L{constructor(){this.state="created",this.bindings=[],this.animations=[],this.animationQueue=[],this.destroyed="",this.moved=""}static create(e,t,r={},s={parent:null,prepare:!0,sibling:null}){const i=new L;return i.model=r,i.element=t,i.bindings.push(...a.parse(i.element,r,i,s.parent)),i.parentElement=e,i.sibling=s.sibling,i.parent=s.parent??a,i.attached=new Promise(o=>{i.attachResolve=o}),i}destroy(){this.element.classList.add("pui-removing"),this.destroyed="queue",a.destroyed.push(this)}terminate(){Promise.all(this.getAnimations()).then(()=>{this.element.parentElement?.removeChild(this.element),this.bindings.forEach(t=>t.unbind());const e=this.parent.views.findIndex(t=>t===this);e>-1&&this.parent.views.splice(e,1)}),this.destroyed="destroyed"}move(e){this.moved="queue",this.element.classList.add("pui-moving"),this.sibling=e}play(e,t){return typeof e=="string"&&(e=this.animations.find(r=>r.name===e).clone()),e.element=t,e.state="pending",this.animationQueue.push(e),this.updateAnimations(performance.now()),e}updateFromUI(){this.bindings.forEach(e=>e.updateFromUI())}updateToUI(){switch(this.bindings.forEach(e=>e.updateToUI()),this.state){case"created":this.element.classList.add("pui-adding"),this.element.hasAttribute("PUI-UNRENDERED")||(this.parentElement??a.parentElement(this.element,this.parent)).insertBefore(this.element,this.sibling?.nextSibling??null),this.attachResolve(),this.state="attaching";break;case"attaching":this.getAnimations(!1).length===0&&(this.element.classList.remove("pui-adding"),this.state="attached");break;case"attached":this.state="rendered";break}}updateAtEvents(){this.bindings.forEach(e=>e.updateAtEvents())}updateAnimations(e){for(;this.animationQueue[0]?.state==="finished";)this.animationQueue.shift().destroy();for(let t=0;t<this.animationQueue.length;t++){const r=this.animationQueue[t];r.state==="pending"&&(r.isBlocked(e)||(r.state="playing",r.startTime=e,r.animation=r.element.animate(r.keyframes,r.options),r.finished=r.animation.finished,r.finished.then(()=>{r.state="finished",this.updateAnimations(performance.now())})))}}updateMove(){switch(this.moved){case"queue":this.moved="move";break;case"move":this.getAnimations().length===0&&(a.parentElement(this.element,this.parent).insertBefore(this.element,this.sibling.nextSibling),this.element.classList.remove("pui-moving"),this.moved="",this.sibling=null);break}this.bindings.forEach(e=>e.updateMove())}getAnimations(e=!0){return this.element.getAnimations({subtree:e}).filter(t=>t.playState!=="finished"&&t.effect?.getTiming().iterations!==1/0).map(t=>t.finished)}}class D{constructor(){this.fromUI=!1,this.toUI=!0,this.atEvent=!1,this.oneTime=!1,this.views=[],this.firstUpdate=!0,this.events=[],this.triggerAtEvent=e=>{this.events.push(e)},this.id=++a.id}get element(){return this.$element==null&&(this.$element=typeof this.selector=="string"?this.context.querySelector(this.selector):this.selector),this.$element}set element(e){this.$element=e}static create(e){const t=new D,r=e.property?.split(":")??[],s=r.shift();return t.object="$model"in e.object?e.object:{$model:e.object},t.property=s,t.arguments=r,t.context=e.context??document,t.selector=e.selector,t.attribute=e.attribute??"innerText",t.value=e.value??t.value,t.template=e.template??t.template,t.fromUI=e.fromUI??t.fromUI,t.toUI=e.toUI??t.toUI,t.atEvent=e.atEvent??t.atEvent,t.oneTime=e.oneTime??t.oneTime,t.parent=e.parent??a,t.addListener(),typeof t.fromUI!="boolean"&&(t.fromUI=t.fromUI.bind(t)),typeof t.toUI!="boolean"&&(t.toUI=t.toUI.bind(t)),t}destroy(){this.element=null,this.removeListener(),this.views.forEach(e=>e.destroy())}unbind(){a.unbind(this)}addListener(){this.atEvent&&(this.toUI=!1,this.fromUI=!1,this.element.addEventListener(this.attribute,this.triggerAtEvent))}removeListener(){this.atEvent&&this.element.removeEventListener(this.attribute,this.triggerAtEvent)}updateFromUI(){if(this.fromUI===!1||this.firstUpdate){this.firstUpdate=!1,this.views.forEach(s=>s.updateFromUI());return}const{target:e,property:t}=a.resolveProperty(this.element,this.attribute),r=e[t];if(r!==this.lastUIValue){let s=this.fromUI!==!0?this.fromUI(r,this.lastUIValue,this.property,this.object):r;if(this.lastUIValue=r,s!==void 0&&s!==this.lastValue){this.lastValue=s;const{target:i,property:o}=a.resolveProperty(this.object,this.property);a.resolveValue(this.object,this.property)==="number"&&!isNaN(s)&&(s=+s),i[o]=s}else this.lastValue=s}this.views.forEach(s=>s.updateFromUI())}updateToUI(){if(this.toUI===!1){this.views.forEach(r=>r.updateToUI());return}let e=a.resolveValue(this.object,this.property),t=!1;if(this.template!=null){if(this.template instanceof HTMLElement)if(typeof this.attribute=="boolean"){if(e=(e??!1)!==!1,e!==this.lastValue){const r=this.toUI!==!0?this.toUI(e,this.lastValue,this.property,this.object):e;r!==void 0&&r!==this.lastUIValue&&(r===this.attribute?this.views.push(L.create(this.element.parentElement,this.template.cloneNode(!0),this.object,{parent:this,prepare:!1,sibling:this.element})):this.views.pop()?.destroy(),this.lastValue=e,this.lastUIValue=r)}}else{e==null&&(e=[]);const r=this.arguments[0],s=this.lastValue??[];if(e.length!==s.length)t=!0;else for(let c=0,g=e.length;c<g;c++){let E,d;if(r==null?(E=e[c],d=s[c]):(E=a.resolveValue(e[c]??{},r),d=a.resolveValue(s[c]??{},r)),E!==d){t=!0;break}}if(!t){this.views.forEach(c=>c.updateToUI()),this.oneTime&&this.oneTimeDone();return}const i=this.toUI!==!0?this.toUI(e,s,this.property,this.object):e;if(i==null){this.views.forEach(c=>c.updateToUI()),this.oneTime&&this.oneTimeDone();return}const o=this.lastUIValue??[];let l=0;for(let c=0,g=i.length,E=0;c<g;c++,E++){let d,f;if(r==null?(d=i[c],f=o[E]):(d=a.resolveValue(i[c]??{},r),f=a.resolveValue(o[E]??{},r)),d===f)l++;else break}if(l===i.length&&i.length===o.length){this.views.forEach(c=>c.updateToUI()),this.oneTime&&this.oneTimeDone();return}const u=this.views.splice(0,l);let h=u[u.length-1];for(let c=l,g=i.length,E=l;c<g;c++,E++){const d=i[c];typeof d!="string"&&(d.$index=c);const f=this.views.shift();if(f==null){const b={$model:{[this.attribute]:d},$parent:this.object},v=L.create(this.element.parentElement,this.template.cloneNode(!0),b,{parent:this,prepare:!1,sibling:h?.element??this.element});u.push(v),h=v;continue}const y=r==null?d:a.resolveValue(d??{},r),I=f?.model.$model[this.attribute],x=r==null?I:a.resolveValue(I??{},r);if(y===x){u.push(f),f.move(h?.element??this.element),h=f;continue}if(!i.slice(c).map(b=>r==null?b:a.resolveValue(b??{},r)).includes(x)){f.destroy(),c--,h=f;continue}this.views.unshift(f);let $=!1;for(let b=0,v=this.views.length;b<v;b++){const w=this.views[b],p=w?.model.$model[this.attribute],j=r==null?p:a.resolveValue(p??{},r);if(y===j){u.push(...this.views.splice(b,1)),w.move(h?.element??this.element),$=!0,h=w;break}}if(!$){const b={$model:{[this.attribute]:d},$parent:this.object},v=L.create(this.element.parentElement,this.template.cloneNode(!0),b,{parent:this,prepare:!1,sibling:h?.element??this.element});u.push(v),h=v}}this.views.forEach(c=>c.destroy()),this.views=u,this.lastValue=[...e],this.lastUIValue=[...i]}else if(this.value==null){const r=a.resolveValue(this.object,this.attribute),s=r.template,i=e==null?r:r.create(e);this.value=e??r,this.views.push(a.create(this.element.parentElement,s,i,{parent:this,prepare:!0,sibling:this.element}))}}else if(e!==this.lastValue){const r=this.toUI!==!0?this.toUI(e,this.lastValue,this.property,this.object):e;if(r!==void 0&&r!==this.lastUIValue){const{target:s,property:i}=a.resolveProperty(this.element,this.attribute);s[i]=r,this.lastValue=e,this.lastUIValue=r}}this.views.forEach(r=>r.updateToUI()),this.oneTime&&this.oneTimeDone()}oneTimeDone(){this.toUI=!1,this.fromUI=!1}updateAtEvents(){let e=this.events.shift();for(;e!=null;)a.resolveValue(this.object,this.property)(e,this.object.$model,this.element,this.attribute,this.object),e=this.events.shift();this.views.forEach(t=>t.updateAtEvents())}updateMove(){this.views.forEach(e=>e.updateMove())}}class a{static initialize(e=!0){if(a.initialized=!0,e!==!1){if(e===!0){const t=()=>{a.update(),requestAnimationFrame(t)};requestAnimationFrame(t);return}setInterval(()=>a.update(),1e3/e)}}static create(e,t,r={},s={parent:null,prepare:!0,sibling:null}){if(typeof t=="string"){const o=e?.ownerDocument??document;t.startsWith("#")&&(t=o.querySelector(t).innerHTML);const l=o.createElement("div");l.innerHTML=s.prepare?a.prepare(t):t,t=l.firstElementChild}const i=L.create(e,t,r,s);return i.parent===a&&a.views.push(i),a.initialized||a.initialize(),i}static play(e,t){return typeof e=="string"?(e=this.globals.animations.find(r=>r.name===e).clone(),e.play(t)):e.play()}static parse(e,t,r,s){const i=[];if(e.nodeType===3){let o=e.textContent,l=o.match(a.regexValue);for(;l!=null;){const u=l[1];let h=l[2];o=l[3];let c=!1;h.startsWith("|")&&(c=!0,h=h.slice(1).trimStart());let g=e.cloneNode();e.textContent=u,a.parentElement(e,s).insertBefore(g,e.nextSibling),i.push(a.bind({selector:g,attribute:"textContent",object:t,property:h,parent:r,oneTime:c})),e=g,g=e.cloneNode(),g.textContent=o,a.parentElement(e,s).insertBefore(g,e.nextSibling),e=g,l=o.match(a.regexValue)}}else{if(i.push(...Object.keys(e.attributes??[]).reverse().map(o=>{const l=[];if(e instanceof Comment)return[];const u=e.attributes[o];if(u.name.startsWith("pui.")){const E=u.value.match(a.regexAttribute);let[d,f,y,I,x]=E,$,b,v=!1;if(y!=="@"){const w=f.match(/^'(.*?)'$/);if(w!=null)$=w[1],e.setAttribute("value",$),f=e.nodeName.toLowerCase()==="option"?"selected":"checked",I=p=>p?$:void 0,y=p=>p===$;else if(f==="")if(I===">"){const{target:p,property:j}=a.resolveProperty(t,x);return p[j]=e,[]}else{const p=document.createComment(u.name);a.parentNode(e,s).insertBefore(p,e),a.parentNode(e,s).removeChild(e),e.removeAttribute(u.name),b=e,e=p,f=y==="=",y=!0,I==="|"&&(v=!0)}else if(I==="="&&y==="="){const p=a.parentNode(e,s);if(p.nodeType!==8){const j=document.createComment(u.name);p.insertBefore(j,e),p.removeChild(e),e.removeAttribute(u.name),e=j}else e=p;b=f,v=!0,y=!0}else if(I==="*"){const p=document.createComment(u.name);a.parentNode(e,s).insertBefore(p,e),a.parentNode(e,s).removeChild(e),e.removeAttribute(u.name),b=e,e=p}else I==="|"?v=!0:f!=="checked"&&e.setAttribute(f,"")}return[a.bind({selector:e,attribute:f,value:$,object:t,property:x,template:b,toUI:typeof y=="string"?y==="<":y,fromUI:typeof I=="string"?I===">":I,atEvent:y==="@",parent:r,oneTime:v})]}const h=[u.value];let c=0,g=h[c].match(a.regexValue);for(;g!=null;){let{before:E,property:d,after:f}=g.groups,y=!1;d.startsWith("|")&&(y=!0,d=d.slice(1).trimStart()),l.push(a.bind({selector:e,attribute:u.name,object:t,property:d,oneTime:y,toUI(I,x,$,b){if(this.oneTime){const w=h.indexOf($);w>-1&&(h[w]=a.resolveValue(b,$),h[w-1]+=h[w]+h[w+1],h.splice(w,2))}const v=h.map((w,p)=>p%2===0?w:a.resolveValue(b,w)).join("");return e.setAttribute(u.name,v),v},parent:r})),h[c++]=E,h[c++]=d,h[c]=f,g=h[c].match(a.regexValue)}return l}).flat()),e instanceof Comment)return i.filter(o=>o.template!=null?!0:(o.unbind(),!1));if(!a.leaveAttributes)for(let o=Object.keys(e.attributes??[]).length-1;o>=0;o--){const l=e.attributes[Object.keys(e.attributes??[])[o]];l.name.startsWith("pui.")&&e.removeAttribute(l.name)}i.push(...Array.from(e.childNodes).map(o=>a.parse(o,t,r,s)).flat())}return i}static bind(e){return D.create(e)}static unbind(e){if(e.destroy(),e.parent!==a){const t=e.parent.bindings,r=t.indexOf(e);r>-1&&t.splice(r,1)}}static update(){this.views.forEach(t=>t.updateFromUI()),this.views.forEach(t=>t.updateToUI()),this.views.forEach(t=>t.updateAtEvents());const e=performance.now();[...this.views,this.globals].forEach(t=>t.updateAnimations(e)),this.views.forEach(t=>{t.updateMove()}),this.destroyed.forEach(t=>{switch(t.destroyed){case"queue":t.state==="rendered"?t.destroyed="destroy":t.updateToUI();break;case"destroy":{t.terminate();const r=this.destroyed.findIndex(s=>t===s);r>-1&&this.destroyed.splice(r,1)}}})}static resolveProperty(e,t){t=t.replace("[",".").replace("]",".");const r=t.split(".").filter(i=>(i??"").length>0);for(;r[0]==="$parent"&&e.$parent!=null;)e=e.$parent,r.shift();let s="$model"in e?e.$model:e;for(;r.length>1;)s=s[r.shift()];return{target:s,property:r[0]}}static resolveValue(e,t){let r=0;do{const{target:s,property:i}=a.resolveProperty(e,t);if(s!=null&&i in s)return s[i];e=e.$parent}while(e!=null&&r++<1e3)}static parentElement(e,t){const r=e.parentElement;if(r!=null)return r;for(;t!=null&&(t.element==null||t.element===e);)t=t.parent;return t?.element}static parentNode(e,t){const r=e.parentNode;if(r!=null)return r;for(;t!=null&&(t.element==null||t.element===e);)t=t.parent;return t?.element}static prepare(e){let t=e;e="";let r=t.match(a.regexReplace);for(;r!=null;){const[s,i,o,l]=r;o.match(/\S\s*===/)?e+=`${i.trimEnd()}br PUI-UNRENDERED PUI.${a.bindingCounter++}="${o}"`:e+=`${i} PUI.${a.bindingCounter++}="${o}" `,t=l,r=t.match(a.regexReplace)}return e+=t,e}}a.initialized=!1;a.id=0;a.views=[];a.destroyed=[];a.globals=new L;a.leaveAttributes=!1;a.regexReplace=/([\S\s]*?)\$\{([^}]*?[<=@!]=[*=>|][^}]*?)\}([\S\s]*)/m;a.regexAttribute=/^\s*(\S*?)\s*([<=@!])=([*=>|])\s*(\S*?)\s*$/;a.regexValue=/(?<before>[\S\s]*?)\$\{\s*(?<property>[\s\S]*?)\s*\}(?<after>[\S\s]*)/m;a.bindingCounter=0;const Q="%[a-f0-9]{2}",W=new RegExp("("+Q+")|([^%]+?)","gi"),z=new RegExp("("+Q+")+","gi");function R(n,e){try{return[decodeURIComponent(n.join(""))]}catch{}if(n.length===1)return n;e=e||1;const t=n.slice(0,e),r=n.slice(e);return Array.prototype.concat.call([],R(t),R(r))}function he(n){try{return decodeURIComponent(n)}catch{let e=n.match(W)||[];for(let t=1;t<e.length;t++)n=R(e,t).join(""),e=n.match(W)||[];return n}}function ue(n){const e={"%FE%FF":"��","%FF%FE":"��"};let t=z.exec(n);for(;t;){try{e[t[0]]=decodeURIComponent(t[0])}catch{const s=he(t[0]);s!==t[0]&&(e[t[0]]=s)}t=z.exec(n)}e["%C2"]="�";const r=Object.keys(e);for(const s of r)n=n.replace(new RegExp(s,"g"),e[s]);return n}function fe(n){if(typeof n!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof n+"`");try{return decodeURIComponent(n)}catch{return ue(n)}}function K(n,e){if(!(typeof n=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(n===""||e==="")return[];const t=n.indexOf(e);return t===-1?[]:[n.slice(0,t),n.slice(t+e.length)]}function de(n,e){const t={};if(Array.isArray(e))for(const r of e){const s=Object.getOwnPropertyDescriptor(n,r);s?.enumerable&&Object.defineProperty(t,r,s)}else for(const r of Reflect.ownKeys(n)){const s=Object.getOwnPropertyDescriptor(n,r);if(s.enumerable){const i=n[r];e(r,i,n)&&Object.defineProperty(t,r,s)}}return t}const pe=n=>n==null,me=n=>encodeURIComponent(n).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),B=Symbol("encodeFragmentIdentifier");function be(n){switch(n.arrayFormat){case"index":return e=>(t,r)=>{const s=t.length;return r===void 0||n.skipNull&&r===null||n.skipEmptyString&&r===""?t:r===null?[...t,[m(e,n),"[",s,"]"].join("")]:[...t,[m(e,n),"[",m(s,n),"]=",m(r,n)].join("")]};case"bracket":return e=>(t,r)=>r===void 0||n.skipNull&&r===null||n.skipEmptyString&&r===""?t:r===null?[...t,[m(e,n),"[]"].join("")]:[...t,[m(e,n),"[]=",m(r,n)].join("")];case"colon-list-separator":return e=>(t,r)=>r===void 0||n.skipNull&&r===null||n.skipEmptyString&&r===""?t:r===null?[...t,[m(e,n),":list="].join("")]:[...t,[m(e,n),":list=",m(r,n)].join("")];case"comma":case"separator":case"bracket-separator":{const e=n.arrayFormat==="bracket-separator"?"[]=":"=";return t=>(r,s)=>s===void 0||n.skipNull&&s===null||n.skipEmptyString&&s===""?r:(s=s===null?"":s,r.length===0?[[m(t,n),e,m(s,n)].join("")]:[[r,m(s,n)].join(n.arrayFormatSeparator)])}default:return e=>(t,r)=>r===void 0||n.skipNull&&r===null||n.skipEmptyString&&r===""?t:r===null?[...t,m(e,n)]:[...t,[m(e,n),"=",m(r,n)].join("")]}}function ge(n){let e;switch(n.arrayFormat){case"index":return(t,r,s)=>{if(e=/\[(\d*)]$/.exec(t),t=t.replace(/\[\d*]$/,""),!e){s[t]=r;return}s[t]===void 0&&(s[t]={}),s[t][e[1]]=r};case"bracket":return(t,r,s)=>{if(e=/(\[])$/.exec(t),t=t.replace(/\[]$/,""),!e){s[t]=r;return}if(s[t]===void 0){s[t]=[r];return}s[t]=[...s[t],r]};case"colon-list-separator":return(t,r,s)=>{if(e=/(:list)$/.exec(t),t=t.replace(/:list$/,""),!e){s[t]=r;return}if(s[t]===void 0){s[t]=[r];return}s[t]=[...s[t],r]};case"comma":case"separator":return(t,r,s)=>{const i=typeof r=="string"&&r.includes(n.arrayFormatSeparator),o=typeof r=="string"&&!i&&A(r,n).includes(n.arrayFormatSeparator);r=o?A(r,n):r;const l=i||o?r.split(n.arrayFormatSeparator).map(u=>A(u,n)):r===null?r:A(r,n);s[t]=l};case"bracket-separator":return(t,r,s)=>{const i=/(\[])$/.test(t);if(t=t.replace(/\[]$/,""),!i){s[t]=r&&A(r,n);return}const o=r===null?[]:r.split(n.arrayFormatSeparator).map(l=>A(l,n));if(s[t]===void 0){s[t]=o;return}s[t]=[...s[t],...o]};default:return(t,r,s)=>{if(s[t]===void 0){s[t]=r;return}s[t]=[...[s[t]].flat(),r]}}}function G(n){if(typeof n!="string"||n.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function m(n,e){return e.encode?e.strict?me(n):encodeURIComponent(n):n}function A(n,e){return e.decode?fe(n):n}function X(n){return Array.isArray(n)?n.sort():typeof n=="object"?X(Object.keys(n)).sort((e,t)=>Number(e)-Number(t)).map(e=>n[e]):n}function Z(n){const e=n.indexOf("#");return e!==-1&&(n=n.slice(0,e)),n}function ye(n){let e="";const t=n.indexOf("#");return t!==-1&&(e=n.slice(t)),e}function H(n,e){return e.parseNumbers&&!Number.isNaN(Number(n))&&typeof n=="string"&&n.trim()!==""?n=Number(n):e.parseBooleans&&n!==null&&(n.toLowerCase()==="true"||n.toLowerCase()==="false")&&(n=n.toLowerCase()==="true"),n}function M(n){n=Z(n);const e=n.indexOf("?");return e===-1?"":n.slice(e+1)}function q(n,e){e={decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1,...e},G(e.arrayFormatSeparator);const t=ge(e),r=Object.create(null);if(typeof n!="string"||(n=n.trim().replace(/^[?#&]/,""),!n))return r;for(const s of n.split("&")){if(s==="")continue;const i=e.decode?s.replace(/\+/g," "):s;let[o,l]=K(i,"=");o===void 0&&(o=i),l=l===void 0?null:["comma","separator","bracket-separator"].includes(e.arrayFormat)?l:A(l,e),t(A(o,e),l,r)}for(const[s,i]of Object.entries(r))if(typeof i=="object"&&i!==null)for(const[o,l]of Object.entries(i))i[o]=H(l,e);else r[s]=H(i,e);return e.sort===!1?r:(e.sort===!0?Object.keys(r).sort():Object.keys(r).sort(e.sort)).reduce((s,i)=>{const o=r[i];return Boolean(o)&&typeof o=="object"&&!Array.isArray(o)?s[i]=X(o):s[i]=o,s},Object.create(null))}function _(n,e){if(!n)return"";e={encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:",",...e},G(e.arrayFormatSeparator);const t=o=>e.skipNull&&pe(n[o])||e.skipEmptyString&&n[o]==="",r=be(e),s={};for(const[o,l]of Object.entries(n))t(o)||(s[o]=l);const i=Object.keys(s);return e.sort!==!1&&i.sort(e.sort),i.map(o=>{const l=n[o];return l===void 0?"":l===null?m(o,e):Array.isArray(l)?l.length===0&&e.arrayFormat==="bracket-separator"?m(o,e)+"[]":l.reduce(r(o),[]).join("&"):m(o,e)+"="+m(l,e)}).filter(o=>o.length>0).join("&")}function ee(n,e){e={decode:!0,...e};let[t,r]=K(n,"#");return t===void 0&&(t=n),{url:t?.split("?")?.[0]??"",query:q(M(n),e),...e&&e.parseFragmentIdentifier&&r?{fragmentIdentifier:A(r,e)}:{}}}function te(n,e){e={encode:!0,strict:!0,[B]:!0,...e};const t=Z(n.url).split("?")[0]||"",r=M(n.url),s={...q(r,{sort:!1}),...n.query};let i=_(s,e);i&&(i=`?${i}`);let o=ye(n.url);if(n.fragmentIdentifier){const l=new URL(t);l.hash=n.fragmentIdentifier,o=e[B]?l.hash:`#${n.fragmentIdentifier}`}return`${t}${i}${o}`}function re(n,e,t){t={parseFragmentIdentifier:!0,[B]:!1,...t};const{url:r,query:s,fragmentIdentifier:i}=ee(n,t);return te({url:r,query:de(s,e),fragmentIdentifier:i},t)}function we(n,e,t){const r=Array.isArray(e)?s=>!e.includes(s):(s,i)=>!e(s,i);return re(n,r,t)}const ve=Object.freeze(Object.defineProperty({__proto__:null,extract:M,parse:q,stringify:_,parseUrl:ee,stringifyUrl:te,pick:re,exclude:we},Symbol.toStringTag,{value:"Module"})),ne=ve.parse(location.search);console.log(ne);const Ee="449687c3",Ie=void 0,F=new Y(Ee,Ie);console.log(F);const U=await F.loginAnonymous();console.log(U);let C;ne.init?(C=await F.createPublicLobby(U),console.log("new room: ",C)):C="132nqoiabao7x";let S=await F.newConnection(C);console.log(S);const se=n=>{console.log("json msg:",n),n.type=="USERLIST"&&(T.users=[],T.users=[...n.users],console.log(...n.users))},ie=n=>{console.error("connection closed",n)};S.onClose(ie);S.onMessageJson(se);await S.connect(U);console.log("Connected to server");S.writeJson({type:"STATUS",msg:"Hello Hathora"});const $e=`
<div class="App">

  <div class="App_Header"> <span>LOBBY TEST</span><span> Username: \${myUserName}</span><span>Room: \${getRoom}</span></div>
  <div class="App_Controls">
    <div class="App_SubControls">
      <button class="button" \${click@=>joinPrivate}>JOIN PRIVATE LOBBY</button>
      <button class="button" \${click@=>newPublic}>CREATE NEW PUBLIC LOBBY</button>
      <button class="button" \${click@=>newPrivate}>CREATE NEW PRIVATE LOBBY</button>
      <button class="button" \${click@=>joinLobby} \${disabled<=>isDisabled}>GOTO LOBBY</button>
    </div>

    <div class="App_List">
        <div class="App_List_rel">
          <div class="App_List_header"> AVAILABLE LOBBYS <button \${click@=>refreshLobbies}>refresh</button></div>
          <div class="App_List_area">
            <div class="entry" \${entry<=*lobbies}>
              <div>\${entry.roomData.roomId}</div>
              <button id="button_\${entry.$index}" data-room="\${entry.roomData.roomId}" \${click@=>entry.join}>Join</button>
            </div>
          </div>
        </div>
    </div>
  </div>
  
  <div class="Lobby_Users">
    Users
    <div style="overflow: auto;">
      <div class="users" \${user<=*users}>\${user}</div> 
    </div>
  </div>
 </div>`,T={get getRoom(){return C=="132nqoiabao7x"?"LOBBY":C},myUserName:"",get isDisabled(){return C=="132nqoiabao7x"},joinPrivate:()=>{const n=prompt("Enter room ID");n&&(O(n),N())},joinLobby:()=>{O("132nqoiabao7x"),N()},lobbies:[],newPublic:async()=>{const n=await F.createPublicLobby(U);O(n),N()},newPrivate:async()=>{const n=await F.createPublicLobby(U);O(n),N()},users:[],refreshLobbies:async()=>{N()}};T.myUserName=Y.getUserFromToken(U).id;a.create(document.body,$e,T);a.initialize(1e3/60);const N=async()=>{T.lobbies=[];let n=await F.getPublicLobbies(U);n=n.filter(e=>e.roomId!="132nqoiabao7x"),console.log(n),n.forEach(e=>{T.lobbies.push({roomData:e,join:async()=>{await O(e.roomId)}})})};N();console.log("lobbies: ",T.lobbies);const O=async n=>{await S.disconnect(),S=await F.newConnection(n),S.connect(U),S.onClose(ie),S.onMessageJson(se),C=n};
